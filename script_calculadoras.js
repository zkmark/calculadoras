function resetColor(){for(var a=document.getElementById("formula"),b=a.getElementsByTagName("i"),c=0;c<b.length;c++)b[c].style.color="#000000"}function cambiarColor(a){resetColor(),calcular(),calcular2();var b=document.getElementById(a);if(b.style.color="#ff0000","IG"==a){var b=document.getElementById("IG");b.style.color="#ff0000";var b=document.getElementById("IG2");b.style.color="#ff0000";var b=document.getElementById("IG3");b.style.color="#ff0000"}if("R"==a){var b=document.getElementById("R");b.style.color="#ff0000";var b=document.getElementById("R2");b.style.color="#ff0000"}if("MPE"==a){var b=document.getElementById("MPE");b.style.color="#ff0000";var b=document.getElementById("MPE2");b.style.color="#ff0000"}if("DE"==a){var b=document.getElementById("DE");b.style.color="#ff0000";var b=document.getElementById("DE2");b.style.color="#ff0000"}}function get_var(a){var b=0;try{return 0!=document.getElementById(a).value.length?b=parseFloat(document.getElementById(a).value):0}catch(a){return 0}}function calcular(){var a=0,b=0,c=0,d=0,e=0;a=get_var("t_MPN")+get_var("t_R")/100*get_var("t_MPE")+get_var("t_MPE")+get_var("t_MO")+get_var("t_ENV")+get_var("t_EMB")+get_var("t_FI")+get_var("t_SI")+get_var("t_CER")+get_var("t_GA")+get_var("t_GDM")+get_var("t_GFB")+get_var("t_OG")-get_var("t_DW")*(1-get_var("t_IG")/100),b=get_var("t_CDA")/100+get_var("t_GB")/100+get_var("t_CA")/100+get_var("t_IP")/100;try{0!=document.getElementById("t_DE").value.length&&(e=get_var("t_DE"),b+=e/(100+e))}catch(a){}try{0!=document.getElementById("t_R").value.length&&(c=get_var("t_R")/100)}catch(a){}try{0!=document.getElementById("t_IG").value.length&&(d=get_var("t_IG")/100)}catch(a){}try{0!=document.getElementById("t_U").value.length&&(b+=get_var("t_U")/100/(1-d))}catch(a){}b=1-b+c*(1-d),a/=b,a+=get_var("t_FIn"),a+=get_var("t_S"),a+=get_var("t_DM"),a+=get_var("t_TI"),a+=get_var("t_II"),document.getElementById("total").innerHTML=Math.round(100*a)/100}function calcular2(){var a=0,b=0,c=0;var_total=document.getElementById("total").innerHTML;try{var_cda=var_total*(get_var("t_CDA")/100),document.getElementById("v_cda").innerHTML=Math.round(100*var_cda)/100}catch(a){}try{var_gb=var_total*(get_var("t_GB")/100),document.getElementById("v_gb").innerHTML=Math.round(100*var_gb)/100}catch(a){}try{var_ca=var_total*(get_var("t_CA")/100),document.getElementById("v_ca").innerHTML=Math.round(100*var_ca)/100}catch(a){}try{var_ip=var_total*(get_var("t_IP")/100),document.getElementById("v_ip").innerHTML=Math.round(100*var_ip)/100}catch(a){}try{a=get_var("t_DE"),var_de=var_total*(a/(100+a)),document.getElementById("v_de").innerHTML=Math.round(100*var_de)/100}catch(a){}try{c=get_var("t_IG")/100}catch(a){}try{var_r=(var_total-get_var("t_MPE"))*(get_var("t_R")/100*(1-c)),document.getElementById("v_r").innerHTML=Math.round(100*var_r)/100}catch(a){}try{b=get_var("t_U")/100,var_u=var_total*(b/(1-c)),document.getElementById("v_u").innerHTML=Math.round(100*var_u)/100}catch(a){}try{var_ig=var_u*c,document.getElementById("v_ig").innerHTML=Math.round(100*var_ig)/100}catch(a){}var_total=var_cda+var_gb+var_ca+var_ip+var_de+var_u-var_r}function validar_form(){var b,a=/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;return v_nombre=document.getElementById("nombre").value,v_email=document.getElementById("email").value,v_coment=document.getElementById("comentarios").value,document.getElementById("lblNombre").innerHTML="",document.getElementById("lblEmail").innerHTML="",document.getElementById("lblComentarios").innerHTML="",""==v_nombre?(b="Ingresar su nombre y apellido",document.form.nombre.focus(),document.getElementById("lblNombre").innerHTML=b,!1):""==v_email?(b="Ingrese un mail.",document.form.email.focus(),document.getElementById("lblEmail").innerHTML=b,!1):a.test(v_email)?""==v_coment?(b="Debe ingresar un comentario",document.form.comentarios.focus(),document.getElementById("lblComentarios").innerHTML=b,!1):void 0:(b="Escriba una direcciÃ³n de correo valida. Ej: info@exportarya.com.ar.",document.form.email.focus(),document.getElementById("lblEmail").innerHTML=b,!1)}function validar(a){var b=/^([0-9])*[.]?[0-9]*$/;if(a?id_tag=a.target.id:(a=window.event,id_tag=a.srcElement.id),v_valor=document.getElementById(id_tag).value,""!=v_valor&&!b.test(v_valor))return alert("El campo debe contener valores numericos. Para separar decimales use punto(.)"),document.getElementById(id_tag).value="",!1}function showToolTip(a){a?id_tag=a.target.id:(a=window.event,id_tag=a.srcElement.id);var b=null;switch(id_tag){case"MPN":b="Materias Primas Nacionales";break;case"MPE":b="Materias Primas Extranjeras";break;case"MPE2":b="Materias Primas Extranjeras";break;case"MO":b="Mano de Obra";break;case"ENV":b="Envases";break;case"EMB":b="Embalajes";break;case"FI":b="Flete Interno";break;case"SI":b="Seguro Interno";break;case"CER":b="Certificaciones";break;case"GA":b="Gastos Aduaneros";break;case"GFB":b="Gastos Fijos Bancarios";break;case"DW":b="Draw Back";break;case"FIn":b="Flete Internacional";break;case"SI":b="Seguro Maritimo";break;case"DM":b="Descarga Mercaderia";break;case"TI":b="Transporte Interno Destino";break;case"II":b="Impuestos de Importación";break;case"OG":b="Otros Gastos";break;case"CDA":b="Comisión Despachante de Aduana";break;case"GB":b="Gastos Bancarios";break;case"CA":b="Comisión de Agente";break;case"IP":b="Intereses de Prefinanciación";break;case"DE":b="Derechos de Exportación";break;case"DE2":b="Derechos de Exportación";break;case"R":b="Reintegros";break;case"R2":b="Reintegros";break;case"IG":b="Impuestos a las Ganancias";break;case"IG2":b="Impuestos a las Ganancias";break;case"IG3":b="Impuestos a las Ganancias";break;case"U":b="Utilidad";break;case"S":b="Seguro Maritimo";break;default:b=null}if(null!=b){var c=document.getElementById("tooltip"),d=document.getElementById("tooltip_text");d.innerHTML=b,c.style.display="block",margin=5;var e=!!document.all;if(e){var f=Math.max(document.body.scrollTop,document.documentElement.scrollTop);tempY=a.clientY-c.offsetHeight+30+f,tempX=a.clientX}else tempX=a.pageX,tempY=a.pageY;tempX<0&&(tempX=0),tempY<0&&(tempY=0),c.style.left=tempX-8+"px",c.style.top=tempY-50+"px"}}function showToolTip(a){a?id_tag=a.target.id:(a=window.event,id_tag=a.srcElement.id);var b=null;switch(id_tag){case"MPN":b="Materias Primas Nacionales";break;case"MPE":b="Materias Primas Extranjeras";break;case"MPE2":b="Materias Primas Extranjeras";break;case"MO":b="Mano de Obra";break;case"ENV":b="Envases";break;case"EMB":b="Embalajes";break;case"FI":b="Flete Interno";break;case"SI":b="Seguro Interno";break;case"CER":b="Certificaciones";break;case"GA":b="Gastos Aduaneros";break;case"GFB":b="Gastos Fijos Bancarios";break;case"DW":b="Draw Back";break;case"FIn":b="Flete Internacional";break;case"SI":b="Seguro Maritimo";break;case"DM":b="Descarga Mercaderia";break;case"TI":b="Transporte Interno Destino";break;case"II":b="Impuestos de Importación";break;case"OG":b="Otros Gastos";break;case"CDA":b="Comisión Despachante de Aduana";break;case"GB":b="Gastos Bancarios";break;case"CA":b="Comisión de Agente";break;case"IP":b="Intereses de Prefinanciación";break;case"DE":b="Derechos de Exportación";break;case"DE2":b="Derechos de Exportación";break;case"R":b="Reintegros";break;case"R2":b="Reintegros";break;case"IG":b="Impuestos a las Ganancias";break;case"IG2":b="Impuestos a las Ganancias";break;case"IG3":b="Impuestos a las Ganancias";break;case"U":b="Utilidad";break;case"S":b="Seguro Maritimo";break;default:b=null}if(null!=b){var c=document.getElementById("tooltip"),d=document.getElementById("tooltip_text");d.innerHTML=b,c.style.display="block";var e=Math.max(document.body.scrollTop,document.documentElement.scrollTop);navigator.userAgent.toLowerCase().indexOf("safari")>=0&&(e=0);var f=a.clientX-8;f<0&&(f=0),c.style.left=f+"px",c.style.top=a.clientY-c.offsetHeight-30+e+"px"}}toolt=function(){for(var a=document.getElementById("formula").getElementsByTagName("i"),b=0;b<a.length;b++)a[b].onmouseover=function(a){showToolTip(a)},a[b].onmouseout=function(){document.getElementById("tooltip").style.display="none"}},window.attachEvent&&window.attachEvent("onload",toolt),window.addEventListener&&window.addEventListener("load",toolt,!1),valid=function(){for(var a=document.getElementById("calculadora").getElementsByTagName("input"),b=0;b<a.length;b++)a[b].onkeyup=function(a){validar(a)}},window.attachEvent&&window.attachEvent("onload",valid),window.addEventListener&&window.addEventListener("load",valid,!1),toolt=function(){for(var a=document.getElementById("formula").getElementsByTagName("i"),b=0;b<a.length;b++)a[b].onmouseover=function(a){showToolTip(a)},a[b].onmouseout=function(){document.getElementById("tooltip").style.display="none"}},window.attachEvent&&window.attachEvent("onload",toolt),window.addEventListener&&window.addEventListener("load",toolt,!1);
